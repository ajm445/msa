# MSA 아키텍처 분석 AI 서비스

## 1. 프로젝트 개요

### 1.1 목적
코드베이스를 분석하여 MSA(Microservice Architecture) 설계 가이드를 제공하는 AI 서비스

### 1.2 주요 기능
- 코드/폴더 구조 업로드 및 분석
- 텍스트 기반 프로젝트 설명 분석
- MSA 서비스 분리 제안
- 새 프로젝트 MSA 설계 가이드 제공

---

## 2. 시스템 아키텍처

```
┌─────────────────────────────────────────────────────────────┐
│                       클라이언트                             │
└─────────────────────────┬───────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────────┐
│                      백엔드 서버                             │
├─────────────────────────────────────────────────────────────┤
│  - 코드 파싱 모듈                                            │
│  - 분석 엔진                                                 │
│  - RAG 파이프라인                                            │
└───────────┬─────────────────────────────────┬───────────────┘
            │                                 │
            ▼                                 ▼
┌───────────────────────┐       ┌───────────────────────────┐
│     Claude API        │       │        Supabase           │
│                       │       │  - PostgreSQL (데이터)     │
│                       │       │  - pgvector (임베딩)       │
└───────────────────────┘       └───────────────────────────┘
```

---

## 3. 기술 스택

| 구분 | 기술 | 비고 |
|------|------|------|
| LLM | Claude API | Anthropic |
| 임베딩 | Voyage AI (voyage-code-3) | 코드 분석 특화 |
| 벡터 DB | Supabase (pgvector) | 임베딩 저장 |
| 데이터베이스 | Supabase (PostgreSQL) | 일반 데이터 |
| 백엔드 | Node.js + Express.js | |
| 프론트엔드 | React | |

---

## 4. 핵심 기능 상세

### 4.1 입력 방식

**방식 1: 코드/폴더 업로드**
- 사용자가 프로젝트 파일을 업로드
- 시스템이 폴더 구조, 의존성, 코드 패턴 자동 분석

**방식 2: 텍스트 설명**
- 사용자가 프로젝트 구조를 텍스트로 설명
- 자연어 기반 분석

### 4.2 분석 프로세스

```
1단계: 코드 구조 파싱
       ↓
2단계: 1차 분석 → MSA 문서 초안 생성 (Claude API)
       ↓
3단계: RAG 기반 2차 분석 → MSA 가이드 문서 참조
       ↓
4단계: 최종 결과 출력
```

### 4.3 지원 언어 및 분석 범위

**백엔드 (MSA 분리 분석)**
- Java/Spring: 서비스 분리, API 경계 정의, DB 분리 제안
- Node.js/Express: 서비스 분리, API 경계 정의, DB 분리 제안

**프론트엔드 (구조 분석)**
- React: 컴포넌트 구조 분석, 모노레포 분리 제안

### 4.4 산출물
- 서비스 분리 제안
- 각 서비스별 책임 정의
- 서비스 간 통신 방식 권고
- 주의사항 및 트레이드오프

---

## 5. 데이터 구조

### 5.1 MSA 가이드 문서 (RAG용)

#### 참조 문서 목록

| 문서명 | 버전 | 설명 |
|--------|------|------|
| MSA_정의서.md | 1.0 | MSA 핵심 개념, 구성 요소, 분리 기준 정의 |
| 도메인_분석_가이드.md | 1.0 | DDD 기반 도메인 분석, Bounded Context 식별 |
| 청킹_전략_정의서.md | 1.0 | RAG용 문서 청킹 규칙 및 메타데이터 정의 |

#### MSA 정의서 구조

```
1. MSA 개요
   - 정의, 핵심 원칙, 모놀리식 vs MSA 비교

2. MSA 구성 요소
   - 서비스, API Gateway, Service Discovery
   - Load Balancer, Circuit Breaker, Message Broker

3. 서비스 간 통신
   - 동기 통신 (REST, gRPC)
   - 비동기 통신 (Event-Driven, Message Queue)

4. 데이터 관리
   - Database per Service, Saga 패턴, CQRS

5. 서비스 분리 기준
   - DDD 기반 분리, 체크리스트, 적정 크기

6. MSA 도입 시 고려사항
   - 장단점, 도입 적합성 평가

7. MSA 분석 AI 서비스 설계 가이드
   - 분석 대상 요소, 서비스 분리 제안 예시

8. 참고 자료
   - 핵심 용어, 주요 기술 스택
```

#### 도메인 분석 가이드 구조

```
1. 도메인 분석 개요
   - 도메인 정의, 필요성, DDD 핵심 개념

2. Bounded Context 식별
   - 식별 방법, 컨텍스트 맵 작성

3. 서브도메인 분류
   - Core / Supporting / Generic Domain

4. 도메인별 분리 예시
   - 이커머스, 소셜미디어, SaaS, 핀테크

5. 도메인 관계 패턴
   - Shared Kernel, Customer-Supplier, ACL 등

6. 실전 분석 체크리스트
   - 도메인 식별, Bounded Context 검증

7. 코드 분석 시 도메인 힌트
   - 패키지 구조, 식별 신호, 분리 주의 신호
```

### 5.2 분석 결과 저장
- (추후 설계)

---

## 6. MVP (Minimum Viable Product)

### 6.1 MVP 목표
RAG 기반으로 프로젝트를 분석하여 MSA 구조를 시각적으로 제안

### 6.2 MVP 기능 범위

| 기능 | 포함 여부 |
|------|----------|
| 코드/폴더 업로드 | ✅ |
| RAG 기반 분석 | ✅ |
| MSA 구조 다이어그램 출력 | ✅ |
| 서비스 분리 제안표 출력 | ✅ |
| 텍스트 설명 기반 분석 | ✅ |
| 분석 결과 저장 | ✅ |
| 분석 히스토리 조회 | ❌ (추후) |

### 6.3 텍스트 설명 기반 분석

사용자가 프로젝트를 텍스트로 설명하면 표 형식으로 정리하여 분석:

**입력 예시**
```
쇼핑몰을 만들려고 합니다. 
회원가입, 상품 관리, 주문, 결제, 배송 추적 기능이 필요해요.
```

**출력 예시**

| 구분 | 내용 |
|------|------|
| 도메인 | 이커머스 (쇼핑몰) |
| 주요 기능 | 회원가입, 상품 관리, 주문, 결제, 배송 추적 |

| 추천 서비스 | 책임 | 유형 |
|------------|------|------|
| User Service | 회원가입 | Supporting |
| Product Service | 상품 관리 | Core |
| Order Service | 주문 처리 | Core |
| Payment Service | 결제 | Generic |
| Shipping Service | 배송 추적 | Generic |

### 6.4 분석 결과 저장

| 저장 항목 | 설명 |
|----------|------|
| 분석 ID | 고유 식별자 |
| 입력 타입 | 코드 업로드 / 텍스트 설명 |
| 입력 내용 | 업로드된 코드 정보 또는 설명 텍스트 |
| 분석 결과 | 서비스 분리 제안, 다이어그램 데이터 |
| 생성일시 | 분석 수행 시간 |

### 6.5 MVP 산출물

**1. MSA 구조 다이어그램**
- 서비스 간 관계를 시각적으로 표현
- 통신 방향 및 의존성 표시

**2. 서비스 분리 제안표**

| 항목 | 설명 |
|------|------|
| 서비스명 | 분리된 각 서비스 이름 |
| 책임 | 해당 서비스의 주요 역할 |
| 주요 엔드포인트 | API 경로 |
| 데이터베이스 | 분리 필요 여부 및 제안 |
| 통신 방식 | REST, 메시지 큐 등 |

---

## 7. 개발 단계 (예정)

| 단계 | 내용 | 상태 |
|------|------|------|
| 1 | MSA 가이드 문서 수집 및 정리 | 예정 |
| 2 | 임베딩 파이프라인 구축 | 예정 |
| 3 | 코드 파싱 모듈 개발 | 예정 |
| 4 | RAG 기반 분석 엔진 개발 | 예정 |
| 5 | API 서버 구축 | 예정 |
| 6 | 프론트엔드 개발 | 예정 |
| 7 | 테스트 및 개선 | 예정 |

---

## 8. 미결정 사항

- [x] ~~우선 지원 언어/프레임워크~~ → Java/Spring, Node.js/Express, React
- [x] ~~임베딩 모델 선택~~ → Voyage AI (voyage-code-3)
- [x] ~~백엔드 프레임워크~~ → Node.js + Express.js
- [x] ~~프론트엔드 프레임워크~~ → React
- [x] ~~MSA 가이드 문서 구조~~ → MSA_정의서.md (v1.0) 추가
- [x] ~~MVP 범위 정의~~ → RAG 기반 분석 + 시각화 출력
- [x] ~~청킹 전략 결정~~ → 섹션 단위 + 메타데이터 (청킹_전략_정의서.md)
- [ ] 추가 참조 문서 수집 (언어별 패턴 가이드, 안티패턴 등)

---

## 9. 변경 이력

| 날짜 | 버전 | 내용 |
|------|------|------|
| 2026-01-07 | 0.1 | 초안 작성 |
| 2026-01-07 | 0.2 | 기술 스택 확정 (Voyage AI, Node.js, React) |
| 2026-01-07 | 0.3 | 지원 언어 확정 (Java/Spring, Node.js/Express, React) |
| 2026-01-07 | 0.4 | MVP 범위 정의 |
| 2026-01-07 | 0.5 | MSA 가이드 문서 추가 (MSA_정의서.md v1.0) |
| 2026-01-07 | 0.6 | 도메인 분석 가이드 추가 (도메인_분석_가이드.md v1.0) |
| 2026-01-07 | 0.7 | 청킹 전략 확정 (청킹_전략_정의서.md v1.0) |
| 2026-01-07 | 0.8 | MVP 범위 수정 (텍스트 분석, 결과 저장 추가) |
